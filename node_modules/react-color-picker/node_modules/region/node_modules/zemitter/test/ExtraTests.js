'use strict'

var root = require('classy')
var should = require('should')
var copy = require('copy-utils').copy
var EventEmitter = require('../index')


describe('EventEmitter', function(){

    it('should correctly return the listeners count for an event', function(){

        var e = EventEmitter()

        should(e.getListenerCountFor('test')).equal(0)
        should(e.hasListenersFor('test')).equal(false)

        should(e.eventQueueState).eql({})

        e.on('test',function(){
        })

        should(e.hasListenersFor('test')).equal(true)
        should(e.getListenerCountFor('test')).equal(1)

        e.off('test')

        should(e.hasListenersFor('test')).equal(false)
        should(e.getListenerCountFor('test')).equal(0)

        should(e.eventQueueState).eql({})
    })

    it('should call generic listener when an event is triggered', function(){

        var e = new EventEmitter()

        var eventCalled,
            args

        e.on('*', function(event, firstArg){
            eventCalled = event
            args = Array.prototype.slice.call(arguments, 0)
        })

        e.emit('test', 5, 'atest')

        should(eventCalled).equal('test')
        should(args).eql(['test',5,'atest'])
    })
})